---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# hlapro

<!-- badges: start -->

<!-- badges: end -->

The goal of hlapro is to provide some tooling to work with [Human Leukocyte Antigen (HLA)](https://en.wikipedia.org/wiki/Human_leukocyte_antigen) data, in the context of transplantation research:

-   HLA typings
-   single bead assays (e.g. Luminex) for detecting HLA-antibodies

The package is currently still in (heavy) development, but ultimately the goal is to support the following functionality:

-   **HLA typings**:
    -   Obtaining HLA mismatches between transplant donor and recipient
    -   Formatting into [GL Strings](https://glstring.org)
    -   Downscaling (reducing) typing resolution
    -   Upscaling (imputing) typing resolution, based on haplotype frequency tables
-   **HLA antibody assays**:
    -   Determining which beads in the assay are positive, based on automated implementations of different methods
    -   Assessing the present of donor-specific antibodies (DSA)

## Installation

You can install the development version of hlapro from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("lcreteig/hlapro")
```

## Usage

```{r}
library(hlapro)
```

### Mismatches

Get mismatched HLAs from donor and recipient typings

```{r mismatch}
donor_typing <- "A1 A2 B5"
recipient_typing <- "A1 A3 B5 B12"

get_mismatches(donor_typing, recipient_typing)
```

### Extracting alleles

Extract HLA alleles from a typing string

```{r extract_alleles}
typing <- "A1 A2 B7 B8 Cw3 DQ5 DQ8 DR4 DR11 DR52 DR53"
extract_alleles_str(typing)

df<- tidyr::tibble(typing = "A1 A2 B7 B8 Cw3 DQ5 DQ8 DR4 DR11 DR52 DR53")
extract_alleles_df(df, "typing", loci = c("A", "B", "C"))
```

### Allele resolution

Determine whether an allele is of low/intermediate/high resolution

```{r resolution}
get_resolution(c("A2", "A*01:AABJE", "B*42:08"))
```

## Other packages

There's many other implementations with partly overlapping goals (some of which hlapro might depend on in the future).

- R:
  - [hlatools](https://github.com/gschofl/hlatools) provides access to the [IPD-IMGT/HLA database](https://www.ebi.ac.uk/ipd/imgt/hla/)
  - [hlaR](https://cran.r-project.org/web/packages/hlaR) does cleaning and imputation of HLA typings
  - [immunotation](http://bioconductor.org/packages/release/bioc/html/immunotation.html) formats HLA typings and can work with haplotype/allele frequencies

- Python:
  - [py-ard](https://github.com/nmdp-bioinformatics/py-ard) reduces HLA typing resolution
  - [pyglstring](https://github.com/nmdp-bioinformatics/pyglstring) checks whether GL Strings are well formatted
  - [ALLAN](https://github.com/lgragert/hla-who-to-unos) converts between serological and molecular HLA notation

## Why `hlapro`?

This package is developed mainly for use in the [**PRO**CARE](https://doi.org/10.1111/tan.13581) project, which (among others) aims to **pro**file (HLA-)antibodies and their role in kidney transplant rejection. hlapro aims to be a one-stop shop for all the analyses in the second iteration of PROCARE.
